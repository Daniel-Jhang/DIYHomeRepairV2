@model DIY_v2.Models.Check
@{
    ViewBag.Title = "ProductDetail";
}

<style>
    /*    .reply-main {
        height: 400px;
        width: 900px;
    }*/
    /*    背景顏色*/
    body {
        background-color: aliceblue;
        color: black
    }
    /*    兩個部份的背景*/
    .Product-area, .Reply-area {
        background-color: white;
        border-radius: 15px;
        padding: 10px;
        margin: 10px;
    }

    /*    以下為留言板CSS*/

    /* Style inputs */
    input[type=text], select, textarea {
        width: 100%;
        padding: 12px;
        border: 1px solid #ccc;
        margin-top: 6px;
        margin-bottom: 16px;
        resize: vertical;
    }

    input[type=submit] {
        background-color: #92badd;
        color: white;
        padding: 12px 20px;
        border: none;
        cursor: pointer;
    }

        input[type=submit]:hover {
            background-color: #A6CAF0;
        }

    /* Style the container/contact section */


    /* Create two columns that float next to eachother */
    .column {
        float: left;
        width: 50%;
        margin-top: 6px;
        padding: 20px;
    }

    /* Clear floats after the columns */
    .row:after {
        content: "";
        display: table;
        clear: both;
    }

    /* Responsive layout - when the screen is less than 600px wide, make the two columns stack on top of each other instead of next to each other */
    @@media screen and (max-width: 600px) {
        .column, input[type=submit] {
            width: 100%;
            margin-top: 0;
        }
    }

    .messageboard {
        display: inline-block;
        letter-spacing: 0.3ch;
        border: 3px solid #333333;
        border-radius: 2% 6% 5% 4% / 1% 1% 2% 4%;
        background-color: #EEE;
    }

    .fromA {
        margin-bottom: 30px;
    }

    .border-image {
        border-radius: 10px;
        border-image-source: linear-gradient(45deg, gold, deeppink);
        border-image-slice: 1;
        border-image-repeat: stretch;
    }

    .messageboardA {
        display: inline-block;
        letter-spacing: 0.3ch;
        border: 3px solid #333333;
        border-radius: 2% 6% 5% 4% / 1% 1% 2% 4%;
        background-color: white;
        margin: auto
    }

    .replyContent {
        background-color: rgba(211,230,246,.3);
        border-radius: 5px;
        margin-left: -40px;
        min-height: 50px;
        padding-left: 40px;
    }
</style>




<section class="ftco-section">
    <div class="container">

        <div class="row">
            <div class="Product-area shadow col-md-12">
                <h3>產品資訊</h3>
                <div class="container">
                    <div class="row">

                        <div class="col-lg-6 mb-5 ftco-animate">
                            @*會彈出圖片*@
                            <a href="@Model.Products_normal[0].ProductImage" class="image-popup prod-img-bg"><img src="@Model.Products_normal[0].ProductImage" class="img-fluid" alt="Colorlib Template"></a>
                        </div>
                        <div class="col-lg-6 product-details pl-md-5 ftco-animate">
                            <h3 class="name">@Model.Products_normal[0].ProductName</h3>
                            <div class="rating d-flex">
                                <p class="text-left mr-4">
                                    @*評價星星*@
                                    <a href="#" class="mr-2">5.0</a>
                                    <a href="#"><span class="ion-ios-star-outline"></span></a>
                                    <a href="#"><span class="ion-ios-star-outline"></span></a>
                                    <a href="#"><span class="ion-ios-star-outline"></span></a>
                                    <a href="#"><span class="ion-ios-star-outline"></span></a>
                                    <a href="#"><span class="ion-ios-star-outline"></span></a>
                                </p>
                                <p class="text-left mr-4">
                                    <a href="#" class="mr-2" style="color: #000;">100 <span style="color: #bbb;">評價</span></a>
                                </p>
                                <p class="text-left">
                                    <a href="#" class="mr-2" style="color: #000;">500 <span style="color: #bbb;">已售出</span></a>
                                </p>
                            </div>
                            <p class="price"><span>$@Model.Products_normal[0].ProductPrice</span></p>


                            <p>@Html.Raw(@Model.Products_normal[0].ProductDescription)</p>



                            <div class="row mt-4">
                                <div class="col-md-12">
                                    <p style="color: #000;">還剩 @Model.Products_normal[0].InStock 件</p>
                                </div>
                                <div class="input-group col-md-8 d-flex mb-3">
                                    <span class="input-group-btn mr-2">
                                        <button type="button" class="quantity-left-minus btn" data-type="minus" data-field="" onclick="sub()">
                                            <i class="ion-ios-remove"></i>
                                        </button>
                                    </span>
                                    <input style="margin-top:0px;" type="text" id="quantity" name="quantity" class="quantity form-control input-number " value="1" min="1" max="100">
                                    <span class="input-group-btn ml-2 ">
                                        <button type="button" class="quantity-right-plus btn" data-type="plus" data-field="" onclick="add()">
                                            <i class="ion-ios-add"></i>
                                        </button>
                                    </span>
                                    &emsp;
                                    @{
                                        if (@User.Identity.Name != String.Empty)
                                        {
                                            <input type="button" class="AdCar" value="加入購物車" />
                                        }
                                        else
                                        {
                                            <input type="button" class="toMember " value="加入購物車" onclick="location.href='https://localhost:44332/Tool/SetClickshopcar'" />


                                        }

                                    }
                                </div>
                                <div class="w-100"></div>

                            </div>
                            <input type="hidden" class="Id" value=@Model.Products_normal[0].ProductID>
                            <input type="hidden" class="ProductPrice" value=@Model.Products_normal[0].ProductPrice>

                        </div>
                    </div>
                </div>


            </div>
        </div>
        <!-- #region 留言區 -->
        <div class="row">
            <div class="Reply-area shadow col-md-12">

                <h4>商品評價</h4>
                @*注意: 有使用Inline margin*@
                <div style="margin-left: 30px;">
                    @{
                        if (Model.replies.Count > 0)
                        {
                            foreach (var item in Model.replies)
                            {
                                <h5>@item.MemberAccount</h5>
                                <div class="row">
                                    <div class="col-md-1"><img class="img-responsive" src="~/Images/TaskerImages/avatar_04.svg" alt="Alternate Text" style="width:35px;" /></div>
                                    <div class="col-md-11 embed-responsive">
                                        <div class="replyContent embed-responsive">@item.Replymain</div>
                                        <span><small>@item.Initdate</small></span>
                                    </div>
                                </div>
                                @*注意: 有使用Inline margin*@
                                @*<span style="margin-left: 60px;"><small>@item.Initdate</small></span>*@
                                <br />
                                <br />
                            }

                            #region 原本的
                            @*<div class="col-md-12">
                                    <table>
                                        <tr>
                                            <th>帳號名稱</th>
                                            <th>留言內容</th>
                                            <th>時間</th>
                                            <th>評分</th>
                                        </tr>
                                        <tr>
                                            <td>@Model.replies[0].MemberAccount</td>
                                            <td>@Model.replies[0].Replymain</td>
                                            <td>@Model.replies[0].Initdate</td>
                                            <td>@Model.replies[0].Star</td>
                                        </tr>
                                    </table>
                                </div>*@
                            #endregion

                        }
                    }
                </div>
                <div style=" display: flex;">
                    <div class="messageboardA column col-md-12">
                        @*<div class="column col-md-12">*@
                        <form method="post" action="@Url.Action("ProductDetail")">
                            <input type="hidden" name="ProductID" value="@Model.Products_normal[0].ProductID" />
                            <textarea class="reply-main" name="replymain" placeholder="請輸入你的評論"></textarea><br />
                            <input type="submit" value="送出" />
                        </form>
                        @*</div>*@
                    </div>
                </div>
                <br />
                <br />
            </div>
            <!-- #endregion -->
        </div>
    </div>



</section>
<script src="~/Scripts/jquery-3.4.1.js"></script>

<script>
    var x = $('.carcount').text();
    $('.AdCar').click(function () {
        var ProductID = $('.Id').val();
        var ProductName = $('.name').text();
        var ProductPrice = parseInt($('.ProductPrice').val());
        var Quantity = parseInt($('.quantity').val());

        $.ajax({
            url: "https://localhost:44332/Tool/AddShoppingcar",
            type: "post",
            data: { "ProductID": ProductID, "ProductName": ProductName, "ProductPrice": ProductPrice, "Quantity": Quantity },
            success() {
                window.alert("已經加入購物車")
                x = (parseInt(x) + 1).toString();


                $('.carcount').text(x);
            }

        })
    })
    function add() {

        var num = parseInt($('.quantity').val());

        num = num + 1;

        $('.quantity').val(num.toString());
    }
    function sub() {

        var num = parseInt($('.quantity').val());
        num = num == 1 ? 1 : num - 1

        $('.quantity').val(num.toString());
    }



</script>